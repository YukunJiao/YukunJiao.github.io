quarto preview
library(worcs)
git_update("add notes and README.md")
git_update("add rendered files")
git_update("update ML chapter 2")
library(worcs)
git_update("add ch5")
library(worcs)
git_update("add ch5 again")
git_update("add ch5 again again")
library(ggplot2)
library(gridExtra)
# 定义 RSS 等高线函数
rss <- function(b1, b2) {
(b1-2)^2 + (b2-1)^2
}
# 创建网格
b1 <- seq(-3, 3, length.out = 100)
b2 <- seq(-3, 3, length.out = 100)
grid <- expand.grid(b1=b1, b2=b2)
grid$rss <- rss(grid$b1, grid$b2)
# Lasso constraint diamond
lasso_constraint <- data.frame(
b1 = c(-2, 0, 2, 0, -2),
b2 = c(0, 2, 0, -2, 0)
)
# Ridge constraint circle
theta <- seq(0, 2*pi, length.out = 100)
ridge_constraint <- data.frame(
b1 = sqrt(2) * cos(theta),
b2 = sqrt(2) * sin(theta)
)
# 基本 RSS 等高线图
p <- ggplot(grid, aes(b1, b2, z=rss)) +
geom_contour(color="red") +
theme_minimal() +
labs(x=expression(beta[1]), y=expression(beta[2])) +
coord_fixed()
# Lasso plot
p_lasso <- p +
geom_polygon(data=lasso_constraint, aes(b1, b2), fill="cyan", alpha=0.5) +
ggtitle("Lasso")
# Ridge plot
p_ridge <- p +
geom_polygon(data=ridge_constraint, aes(b1, b2), fill="cyan", alpha=0.5) +
ggtitle("Ridge")
# 并排显示
grid.arrange(p_lasso, p_ridge, ncol=2)
